
================================================================================
ドキュメント: プログラム基本設計書_基礎-コンポーネント_LogUtil_処理詳細_V2.pdf (PDF 1)
ファイル名: プログラム基本設計書_基礎-コンポーネント_LogUtil_処理詳細_V2.pdf
================================================================================

3-1.処理詳細説明(全体)

プログラムID

LogUtil

詳細内容

・目的

f013カタログ部品データ作成

システム名
業務機能名 基礎-コンポーネント
プログラム名称 LogUtil

システムID
バージョン
プロジェクトNo

作成日
更新日

2025/2/8

作成者
2025/10/30 更新者
区分

3H.薛宸
3H.薛宸

汎用

12000599-00

改訂No. 削

累積や累計などのPGに共通している部分を共通のDLLとして作成し、システムの安定性と開発効率を向上させる

・概要

システムにおける各種ログ出力の要件として、以下の出力先を実装する。

1 コンソール出力

アプリケーションの標準出力にログを出力する。
開発・デバッグ用途として利用し、

2 ログファイル出力

ログをファイルに記録し、システム運用時のトラブルシューティングや監査に活用する。
出力先のパス、ログのローテーション設定、および保持期間を適切に設計する。

3 クラウドロギング

CloudLoggingを使って、処理ログを指定の箇所に出力する。

・ログ出力制御ルール

LogType

メッセージタイプ

ログの種類

コンソールログ

ローカルログ Cloud Logging　※1

※1：常にスタックトレースを出す

Debug

Release

ERROR
WARNING
INFORMATION
PROCESS
STACKTRACE
ERROR
WARNING
INFORMATION
PROCESS
STACKTRACE

CloudLogging：

debug：

〇
〇
〇
〇
✖
〇
〇
〇
✖
✖

〇
〇
〇
〇
〇
〇
〇
〇
✖
✖

〇
〇
〇
〇
〇
〇
〇
〇
✖
〇

すべてのログを出力する

INFORMATION、PROCESS、WARNING、ERROR、STACKTRACE

release：

PROCESS以外のログを出力する

INFORMATION、WARNING、ERROR、STACKTRACE

ローカルログ：

ローカルログとして1つのファイルに出力し、ファイル名は「ツールID.log」(ツールIDは引数"logId"を使用)とする。

debug：

2
2

2

2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2

2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2

すべてのログを出力する

INFORMATION、PROCESS、WARNING、ERROR、STACKTRACE

release：

以下のログを出力する

INFORMATION、WARNING、ERROR、STACKTRACE

コンソールログ：

スタックトレースがコンソールログに出力されない

debug：

以下のログを出力する

INFORMATION、PROCESS、WARNING、ERROR

release：

以下のログを出力する

INFORMATION、WARNING、ERROR

・処理明細

各関数の動作を説明する。

クラス名:

ILog

機能:

インターフェースクラス。ログ出力を規格化するために使用されます。

①　関数: WriteLog

機能:

ログ出力のインターフェース関数。

void WriteLog(string msg, LogLevelEnum logLevel);

msg:ログ内容
logLevel:ログレベル

引数:

処理:

戻り値:

なし

異常処理:

②　関数:

LogDebug

機能:

Debugレベルのログ出力のインターフェース関数。

void LogDebug(string msg);

引数:

msg:ログ内容

処理:

2

2

2

戻り値:

なし

異常処理:

③　関数:

LogProcess

機能:

Processログ出力のインターフェース関数。

void LogProcess(string msg);

引数:

msg:ログ内容

処理:

戻り値:

なし

異常処理:

④　関数:

LogInfo

機能:

Infoレベルのログ出力のインターフェース関数。

void LogInfo(string msg);

引数:

msg:ログ内容

処理:

戻り値:

なし

異常処理:

⑤　関数:

LogWarn

機能:

Warnレベルのログ出力のインターフェース関数。

void LogWarn(string msg);

引数:

msg:ログ内容

処理:

戻り値:

なし

異常処理:

⑥　関数:

LogError

機能:

Errorレベルのログ出力のインターフェース関数。

void LogError(string msg);

引数:

msg:ログ内容

処理:

戻り値:

なし

異常処理:

⑦　関数:

LogException

機能:

異常情報出力のインターフェース関数。

void LogException(Exception ex);

引数:

ex:異常

処理:

戻り値:

なし

異常処理:

クラス名:

LogLevelEnum

機能:

列挙型クラス。ログレベルを定義する。

DEBUG
PROCESS
INFO
WARN
ERROR

クラス名:

AbstractLog

機能:

抽象クラス。ILogを継承し、ログ内容のフォーマットなどのメソッドを提供する。

①　関数: AbstractLog

機能:

コンストラクタ。ログ内容のタイトルをフォーマットする。

public AbstractLog(LogLabel logLabel，string logLevel)

引数:

logLabel：

nameSpace:ネームスペース
workFlowName:ワークフロー名
executeTaskId:実行タスクID

logLevel:ログの出力レベル

処理:

タイトルをフォーマットする。

2

2

2
2
2
2

2

戻り値:

なし

異常処理:

②　関数:

FormatMsg

機能:

ログ内容をフォーマットする。

public string FormatMsg(string msg, LogLevelEnum msgType)

引数:

msg:ログ内容
msgType:ログレベル

処理:

ログ内容をフォーマットする。

戻り値:

string, フォーマットされたログ内容

異常処理:

③　関数: GetNowJapanDateTime

機能:

現在時刻(Japan)を取得する。

public DateTime GetNowJapanDateTime()

引数:

なし

処理:

現在時刻(Japan)の取得

戻り値:

DateTime:現在時刻(Japan)

異常処理:

④　関数:

IsDebugMode

機能:

デバッグモードかどうかを判定する

public bool IsDebugMode()

引数:

処理:

デバッグモードかどうかを判定する

戻り値:

logLevel が 「debug」の場合は true
「release」の場合は false

異常処理:

クラス名:

CloudLoggingUtil

機能:

AbstractLog抽象クラスを実装し、Cloudログを書き込むためのインターフェース関数をカプセル化する。

①　関数: CloudLoggingUtil

2
2
2
2
2
2
2
2
2
2
2
2
2

機能:

コンストラクタ。CloudLogging APIを初期化する。

public CloudLoggingUtil(string projectId, string logId, LogLabel logLabel,string logLevel) : base(loglabel,logLevel)

引数:

projectId:GCPプロジェクトID
logId:ログインスタンス名
logLabel：

nameSpace:ネームスペース
workFlowName:ワークフロー名
executeTaskId:実行タスクID

logLevel:ログの出力レベル

処理:

CloudLogging APIインスタンスを初期化する。

戻り値:

なし

異常処理:

②　関数: WriteLog

機能:

ログを出力する。

public override void WriteLog(string msg, LogLevelEnum msgType);

引数:

msg:ログ内容
msgType:ログレベル

処理:

ログをCloudに出力する。

戻り値:

なし

異常処理:

③　関数:

LogDebug

機能:

Debugレベルのログ出力のインターフェース関数。

void LogDebug(string msg);

引数:

msg:ログ内容

処理:

戻り値:

なし

異常処理:

④　関数:

LogProcess

機能:

Processログを出力する。

2
2
2
2
2

2

2

public override void LogProcess(string msg);

引数:

msg:ログ内容

処理:

logLevelが「release」に設定されている場合は、Processログを出力しません。
「debug」に設定されている場合は、Processログを出力します。

2

2
2

戻り値:

なし

異常処理:

⑤　関数:

LogInfo

機能:

Infoレベルのログを出力する。

public override void LogInfo(string msg);

引数:

msg:ログ内容

処理:

InfoレベルのログをCloudに出力する。

戻り値:

なし

異常処理:

⑥　関数:

LogWarn

機能:

Warnレベルのログを出力する。

public override void LogWarn(string msg);

引数:

msg:ログ内容

処理:

WarnレベルのログをCloudに出力する。

戻り値:

なし

異常処理:

⑦　関数:

LogError

機能:

Errorレベルのログを出力する。

public override void LogError(string msg);

引数:

msg:ログ内容

処理:

ErrorレベルのログをCloudに出力する。

戻り値:

なし

異常処理:

⑧　関数:

LogException

機能:

異常情報を出力する。

public override void LogException(Exception ex);

引数:

ex:異常

処理:

異常情報をCloudに出力する。

戻り値:

なし

異常処理:

クラス名:

LogFileUtil

機能:

AbstractLog抽象クラスを実装し、ログファイルを書き込むためのインターフェース関数をカプセル化する。

①　関数:

LogFileUtil

機能:

コンストラクタ。ログディレクトリを初期化する。

public LogFileUtil(string logFilePath, LogLabel logLabel ,string logLevel) : base(logLabel,logLevel)

引数:

logFilePath:ログファイルのパス
logLabel：

nameSpace:ネームスペース
workFlowName:ワークフロー名
executeTaskId:実行タスクID

logLevel:ログの出力レベル

処理:

ログディレクトリを初期化します。

戻り値:

なし

異常処理:

②　関数: WriteLog

機能:

ログを出力する。

public override void WriteLog(string msg, LogLevelEnum msgType);

引数:

処理:

msg:ログ内容
msgType:ログレベル

logLevelが「release」に設定されている場合は、Processログを出力しません。
「debug」に設定されている場合は、Processログを出力します。

戻り値:

なし

2
2
2
2
2

2
2

異常処理:

③　関数:

LogDebug

機能:

Debugレベルのログ出力のインターフェース関数。

void LogDebug(string msg);

引数:

msg:ログ内容

処理:

戻り値:

なし

異常処理:

④　関数:

LogProcess

機能:

Processログを出力する。

public override void LogProcess(string msg);

引数:

msg:ログ内容

処理:

Processログをファイルに出力する。

戻り値:

なし

異常処理:

⑤　関数:

LogInfo

機能:

Infoレベルのログを出力する。

public override void LogInfo(string msg);

引数:

msg:ログ内容

処理:

Infoレベルのログをファイルに出力する。

戻り値:

なし

異常処理:

⑥　関数:

LogWarn

機能:

Warnレベルのログを出力する。

public override void LogWarn(string msg);

引数:

msg:ログ内容

2

2

2

2

処理:

Warnレベルのログをファイルに出力する。

戻り値:

なし

異常処理:

⑦　関数:

LogError

機能:

Errorレベルのログを出力する。

public override void LogError(string msg);

引数:

msg:ログ内容

処理:

Errorレベルのログをファイルに出力する。

戻り値:

なし

異常処理:

⑧　関数:

LogException

機能:

異常情報を出力する。

public override void LogException(Exception ex);

引数:

ex:異常

処理:

異常メッセージはreleaseログファイルに出力するが、スタックトレース情報はreleaseログファイルには出力しない。
logLevelが「debug」に設定されている場合は、異常メッセージおよびスタックトレース情報の両方をログファイルに出力する。

戻り値:

なし

異常処理:

クラス名:

ConsoleLoggingUtil

機能:

AbstractLog抽象クラスを実装し、コンソールログを書き込むためのインターフェース関数をカプセル化する。

①　関数: ConsoleLoggingUtil

機能:

コンストラクタ。

public ConsoleLoggingUtil(LogLabel logLabel,string logLevel) : base(logLabel,logLevel)

引数:

logLabel：

nameSpace:ネームスペース
workFlowName:ワークフロー名
executeTaskId:実行タスクID

logLevel:ログレベル

2
2

2
2
2
2

2

処理:

戻り値:

なし

異常処理:

②　関数: WriteLog

機能:

ログを出力する。

public override void WriteLog(string msg, LogLevelEnum msgType);

引数:

処理:

msg:ログ内容
msgType:ログレベル

ログをコンソールに出力する。
logLevelが「release」に設定されている場合は、Processログを出力しません。
「debug」に設定されている場合は、Processログを出力します。

戻り値:

なし

異常処理:

③　関数:

LogDebug

機能:

Debugレベルのログ出力のインターフェース関数。

void LogDebug(string msg);

引数:

msg:ログ内容

処理:

戻り値:

なし

異常処理:

④　関数:

LogProcess

機能:

Processログを出力する。

public override void LogProcess(string msg);

引数:

msg:ログ内容

処理:

Processログをコンソールに出力する。

戻り値:

なし

異常処理:

2
2

2

2

2

2

⑤　関数:

LogInfo

機能:

Infoレベルのログを出力する。

public override void LogInfo(string msg);

引数:

msg:ログ内容

処理:

Infoレベルのログをコンソールに出力する。

戻り値:

なし

異常処理:

⑥　関数:

LogWarn

機能:

Warnレベルのログを出力する。

public override void LogWarn(string msg);

引数:

msg:ログ内容

処理:

Warnレベルのログをコンソールに出力する。

戻り値:

なし

異常処理:

⑦　関数:

LogError

機能:

Errorレベルのログを出力する。

public override void LogError(string msg);

引数:

msg:ログ内容

処理:

Errorレベルのログをコンソールに出力する。

戻り値:

なし

異常処理:

⑧　関数:

LogException

機能:

異常情報を出力しする。

public override void LogException(Exception ex);

引数:

ex:異常

処理:

異常（エラー）メッセージのみをコンソールに出力し、スタックトレースは出力しない。

2

戻り値:

なし

異常処理:

クラス名:

LogUtil

機能:

 ILogインターフェースを実装し、CloudLoggingUtil、LogFileUtil、ConsoleLoggingUtilを使用してログを書き込みます。

①　関数:

LogUtil

機能:

コンストラクタ。

public LogUtil(LogEntity log)

引数:

log:

projectId:GCPプロジェクトID
logId:ログインスタンス名
nameSpace:ネームスペース
workFlowName:ワークフロー名
executeTaskId:実行タスクID
logFileFolderPath:ログファイル保存フォルダパス
logTypeList:出力ログタイプ
logLevel:ログの出力レベル

処理:

logTypeListに基づいて、必要に応じてCloudLoggingUtil、LogFileUtil、ConsoleLoggingUtilを作成する。

戻り値:

なし

異常処理:

②　関数: WriteLog

機能:

ログを出力する。

public override void WriteLog(string msg, LogLevelEnum msgType);

引数:

msg:ログ内容
msgType:ログレベル

処理:

ログを必要に応じてCloud、ファイル、コンソールに出力する。

戻り値:

なし

異常処理:

③　関数:

LogDebug

機能:

Debugレベルのログ出力のインターフェース関数。

void LogDebug(string msg);

引数:

msg:ログ内容

2
2
2
2
2
2
2
2
2

2

2

2

2

処理:

戻り値:

なし

異常処理:

④　関数:

LogProcess

機能:

Processログを出力する。

public override void LogProcess(string msg);

引数:

msg:ログ内容

処理:

Processログを、Console以外の他の種類のログに出力する

・CloudlLogging
・Local

戻り値:

なし

異常処理:

⑤　関数:

LogInfo

機能:

Infoレベルのログを出力する。

public override void LogInfo(string msg);

引数:

msg:ログ内容

処理:

Infoレベルのログを必要に応じてCloud、ファイル、コンソールに出力する。

戻り値:

なし

異常処理:

⑥　関数:

LogWarn

機能:

Warnレベルのログを出力する。

public override void LogWarn(string msg);

引数:

msg:ログ内容

処理:

Warnレベルのログを必要に応じてCloud、ファイル、コンソールに出力する。

戻り値:

なし

異常処理:

⑦　関数:

LogError

機能:

Errorレベルのログを出力する。

public override void LogError(string msg);

引数:

msg:ログ内容

処理:

Errorレベルのログを必要に応じてCloud、ファイル、コンソールに出力する。

戻り値:

なし

異常処理:

⑧　関数:

LogException

機能:

異常情報を出力する。

public override void LogException(Exception ex);

引数:

ex:異常

処理:

異常情報を必要に応じてCloud、ファイル、コンソールに出力する。

戻り値:

なし

異常処理:





================================================================================
ドキュメント: プログラム基本設計書_基礎-コンポーネント_LogUtil_処理詳細_V2.pdf (PDF 2)
ファイル名: プログラム基本設計書_基礎-コンポーネント_LogUtil_処理詳細_V2.pdf
================================================================================

3-1.処理詳細説明(全体)

プログラムID

LogUtil

詳細内容

・目的

f013カタログ部品データ作成

システム名
業務機能名 基礎-コンポーネント
プログラム名称 LogUtil

システムID
バージョン
プロジェクトNo

作成日
更新日

2025/2/8

作成者
2025/10/30 更新者
区分

3H.薛宸
3H.薛宸

汎用

12000599-00

改訂No. 削

累積や累計などのPGに共通している部分を共通のDLLとして作成し、システムの安定性と開発効率を向上させる

・概要

システムにおける各種ログ出力の要件として、以下の出力先を実装する。

1 コンソール出力

アプリケーションの標準出力にログを出力する。
開発・デバッグ用途として利用し、

2 ログファイル出力

ログをファイルに記録し、システム運用時のトラブルシューティングや監査に活用する。
出力先のパス、ログのローテーション設定、および保持期間を適切に設計する。

3 クラウドロギング

CloudLoggingを使って、処理ログを指定の箇所に出力する。

・ログ出力制御ルール

LogType

メッセージタイプ

ログの種類

コンソールログ

ローカルログ Cloud Logging　※1

※1：常にスタックトレースを出す

Debug

Release

ERROR
WARNING
INFORMATION
PROCESS
STACKTRACE
ERROR
WARNING
INFORMATION
PROCESS
STACKTRACE

CloudLogging：

debug：

〇
〇
〇
〇
✖
〇
〇
〇
✖
✖

〇
〇
〇
〇
〇
〇
〇
〇
✖
✖

〇
〇
〇
〇
〇
〇
〇
〇
✖
〇

すべてのログを出力する

INFORMATION、PROCESS、WARNING、ERROR、STACKTRACE

release：

PROCESS以外のログを出力する

INFORMATION、WARNING、ERROR、STACKTRACE

ローカルログ：

ローカルログとして1つのファイルに出力し、ファイル名は「ツールID.log」(ツールIDは引数"logId"を使用)とする。

debug：

2
2

2

2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2

2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2

すべてのログを出力する

INFORMATION、PROCESS、WARNING、ERROR、STACKTRACE

release：

以下のログを出力する

INFORMATION、WARNING、ERROR、STACKTRACE

コンソールログ：

スタックトレースがコンソールログに出力されない

debug：

以下のログを出力する

INFORMATION、PROCESS、WARNING、ERROR

release：

以下のログを出力する

INFORMATION、WARNING、ERROR

・処理明細

各関数の動作を説明する。

クラス名:

ILog

機能:

インターフェースクラス。ログ出力を規格化するために使用されます。

①　関数: WriteLog

機能:

ログ出力のインターフェース関数。

void WriteLog(string msg, LogLevelEnum logLevel);

msg:ログ内容
logLevel:ログレベル

引数:

処理:

戻り値:

なし

異常処理:

②　関数:

LogDebug

機能:

Debugレベルのログ出力のインターフェース関数。

void LogDebug(string msg);

引数:

msg:ログ内容

処理:

2

2

2

戻り値:

なし

異常処理:

③　関数:

LogProcess

機能:

Processログ出力のインターフェース関数。

void LogProcess(string msg);

引数:

msg:ログ内容

処理:

戻り値:

なし

異常処理:

④　関数:

LogInfo

機能:

Infoレベルのログ出力のインターフェース関数。

void LogInfo(string msg);

引数:

msg:ログ内容

処理:

戻り値:

なし

異常処理:

⑤　関数:

LogWarn

機能:

Warnレベルのログ出力のインターフェース関数。

void LogWarn(string msg);

引数:

msg:ログ内容

処理:

戻り値:

なし

異常処理:

⑥　関数:

LogError

機能:

Errorレベルのログ出力のインターフェース関数。

void LogError(string msg);

引数:

msg:ログ内容

処理:

戻り値:

なし

異常処理:

⑦　関数:

LogException

機能:

異常情報出力のインターフェース関数。

void LogException(Exception ex);

引数:

ex:異常

処理:

戻り値:

なし

異常処理:

クラス名:

LogLevelEnum

機能:

列挙型クラス。ログレベルを定義する。

DEBUG
PROCESS
INFO
WARN
ERROR

クラス名:

AbstractLog

機能:

抽象クラス。ILogを継承し、ログ内容のフォーマットなどのメソッドを提供する。

①　関数: AbstractLog

機能:

コンストラクタ。ログ内容のタイトルをフォーマットする。

public AbstractLog(LogLabel logLabel，string logLevel)

引数:

logLabel：

nameSpace:ネームスペース
workFlowName:ワークフロー名
executeTaskId:実行タスクID

logLevel:ログの出力レベル

処理:

タイトルをフォーマットする。

2

2

2
2
2
2

2

戻り値:

なし

異常処理:

②　関数:

FormatMsg

機能:

ログ内容をフォーマットする。

public string FormatMsg(string msg, LogLevelEnum msgType)

引数:

msg:ログ内容
msgType:ログレベル

処理:

ログ内容をフォーマットする。

戻り値:

string, フォーマットされたログ内容

異常処理:

③　関数: GetNowJapanDateTime

機能:

現在時刻(Japan)を取得する。

public DateTime GetNowJapanDateTime()

引数:

なし

処理:

現在時刻(Japan)の取得

戻り値:

DateTime:現在時刻(Japan)

異常処理:

④　関数:

IsDebugMode

機能:

デバッグモードかどうかを判定する

public bool IsDebugMode()

引数:

処理:

デバッグモードかどうかを判定する

戻り値:

logLevel が 「debug」の場合は true
「release」の場合は false

異常処理:

クラス名:

CloudLoggingUtil

機能:

AbstractLog抽象クラスを実装し、Cloudログを書き込むためのインターフェース関数をカプセル化する。

①　関数: CloudLoggingUtil

2
2
2
2
2
2
2
2
2
2
2
2
2

機能:

コンストラクタ。CloudLogging APIを初期化する。

public CloudLoggingUtil(string projectId, string logId, LogLabel logLabel,string logLevel) : base(loglabel,logLevel)

引数:

projectId:GCPプロジェクトID
logId:ログインスタンス名
logLabel：

nameSpace:ネームスペース
workFlowName:ワークフロー名
executeTaskId:実行タスクID

logLevel:ログの出力レベル

処理:

CloudLogging APIインスタンスを初期化する。

戻り値:

なし

異常処理:

②　関数: WriteLog

機能:

ログを出力する。

public override void WriteLog(string msg, LogLevelEnum msgType);

引数:

msg:ログ内容
msgType:ログレベル

処理:

ログをCloudに出力する。

戻り値:

なし

異常処理:

③　関数:

LogDebug

機能:

Debugレベルのログ出力のインターフェース関数。

void LogDebug(string msg);

引数:

msg:ログ内容

処理:

戻り値:

なし

異常処理:

④　関数:

LogProcess

機能:

Processログを出力する。

2
2
2
2
2

2

2

public override void LogProcess(string msg);

引数:

msg:ログ内容

処理:

logLevelが「release」に設定されている場合は、Processログを出力しません。
「debug」に設定されている場合は、Processログを出力します。

2

2
2

戻り値:

なし

異常処理:

⑤　関数:

LogInfo

機能:

Infoレベルのログを出力する。

public override void LogInfo(string msg);

引数:

msg:ログ内容

処理:

InfoレベルのログをCloudに出力する。

戻り値:

なし

異常処理:

⑥　関数:

LogWarn

機能:

Warnレベルのログを出力する。

public override void LogWarn(string msg);

引数:

msg:ログ内容

処理:

WarnレベルのログをCloudに出力する。

戻り値:

なし

異常処理:

⑦　関数:

LogError

機能:

Errorレベルのログを出力する。

public override void LogError(string msg);

引数:

msg:ログ内容

処理:

ErrorレベルのログをCloudに出力する。

戻り値:

なし

異常処理:

⑧　関数:

LogException

機能:

異常情報を出力する。

public override void LogException(Exception ex);

引数:

ex:異常

処理:

異常情報をCloudに出力する。

戻り値:

なし

異常処理:

クラス名:

LogFileUtil

機能:

AbstractLog抽象クラスを実装し、ログファイルを書き込むためのインターフェース関数をカプセル化する。

①　関数:

LogFileUtil

機能:

コンストラクタ。ログディレクトリを初期化する。

public LogFileUtil(string logFilePath, LogLabel logLabel ,string logLevel) : base(logLabel,logLevel)

引数:

logFilePath:ログファイルのパス
logLabel：

nameSpace:ネームスペース
workFlowName:ワークフロー名
executeTaskId:実行タスクID

logLevel:ログの出力レベル

処理:

ログディレクトリを初期化します。

戻り値:

なし

異常処理:

②　関数: WriteLog

機能:

ログを出力する。

public override void WriteLog(string msg, LogLevelEnum msgType);

引数:

処理:

msg:ログ内容
msgType:ログレベル

logLevelが「release」に設定されている場合は、Processログを出力しません。
「debug」に設定されている場合は、Processログを出力します。

戻り値:

なし

2
2
2
2
2

2
2

異常処理:

③　関数:

LogDebug

機能:

Debugレベルのログ出力のインターフェース関数。

void LogDebug(string msg);

引数:

msg:ログ内容

処理:

戻り値:

なし

異常処理:

④　関数:

LogProcess

機能:

Processログを出力する。

public override void LogProcess(string msg);

引数:

msg:ログ内容

処理:

Processログをファイルに出力する。

戻り値:

なし

異常処理:

⑤　関数:

LogInfo

機能:

Infoレベルのログを出力する。

public override void LogInfo(string msg);

引数:

msg:ログ内容

処理:

Infoレベルのログをファイルに出力する。

戻り値:

なし

異常処理:

⑥　関数:

LogWarn

機能:

Warnレベルのログを出力する。

public override void LogWarn(string msg);

引数:

msg:ログ内容

2

2

2

2

処理:

Warnレベルのログをファイルに出力する。

戻り値:

なし

異常処理:

⑦　関数:

LogError

機能:

Errorレベルのログを出力する。

public override void LogError(string msg);

引数:

msg:ログ内容

処理:

Errorレベルのログをファイルに出力する。

戻り値:

なし

異常処理:

⑧　関数:

LogException

機能:

異常情報を出力する。

public override void LogException(Exception ex);

引数:

ex:異常

処理:

異常メッセージはreleaseログファイルに出力するが、スタックトレース情報はreleaseログファイルには出力しない。
logLevelが「debug」に設定されている場合は、異常メッセージおよびスタックトレース情報の両方をログファイルに出力する。

戻り値:

なし

異常処理:

クラス名:

ConsoleLoggingUtil

機能:

AbstractLog抽象クラスを実装し、コンソールログを書き込むためのインターフェース関数をカプセル化する。

①　関数: ConsoleLoggingUtil

機能:

コンストラクタ。

public ConsoleLoggingUtil(LogLabel logLabel,string logLevel) : base(logLabel,logLevel)

引数:

logLabel：

nameSpace:ネームスペース
workFlowName:ワークフロー名
executeTaskId:実行タスクID

logLevel:ログレベル

2
2

2
2
2
2

2

処理:

戻り値:

なし

異常処理:

②　関数: WriteLog

機能:

ログを出力する。

public override void WriteLog(string msg, LogLevelEnum msgType);

引数:

処理:

msg:ログ内容
msgType:ログレベル

ログをコンソールに出力する。
logLevelが「release」に設定されている場合は、Processログを出力しません。
「debug」に設定されている場合は、Processログを出力します。

戻り値:

なし

異常処理:

③　関数:

LogDebug

機能:

Debugレベルのログ出力のインターフェース関数。

void LogDebug(string msg);

引数:

msg:ログ内容

処理:

戻り値:

なし

異常処理:

④　関数:

LogProcess

機能:

Processログを出力する。

public override void LogProcess(string msg);

引数:

msg:ログ内容

処理:

Processログをコンソールに出力する。

戻り値:

なし

異常処理:

2
2

2

2

2

2

⑤　関数:

LogInfo

機能:

Infoレベルのログを出力する。

public override void LogInfo(string msg);

引数:

msg:ログ内容

処理:

Infoレベルのログをコンソールに出力する。

戻り値:

なし

異常処理:

⑥　関数:

LogWarn

機能:

Warnレベルのログを出力する。

public override void LogWarn(string msg);

引数:

msg:ログ内容

処理:

Warnレベルのログをコンソールに出力する。

戻り値:

なし

異常処理:

⑦　関数:

LogError

機能:

Errorレベルのログを出力する。

public override void LogError(string msg);

引数:

msg:ログ内容

処理:

Errorレベルのログをコンソールに出力する。

戻り値:

なし

異常処理:

⑧　関数:

LogException

機能:

異常情報を出力しする。

public override void LogException(Exception ex);

引数:

ex:異常

処理:

異常（エラー）メッセージのみをコンソールに出力し、スタックトレースは出力しない。

2

戻り値:

なし

異常処理:

クラス名:

LogUtil

機能:

 ILogインターフェースを実装し、CloudLoggingUtil、LogFileUtil、ConsoleLoggingUtilを使用してログを書き込みます。

①　関数:

LogUtil

機能:

コンストラクタ。

public LogUtil(LogEntity log)

引数:

log:

projectId:GCPプロジェクトID
logId:ログインスタンス名
nameSpace:ネームスペース
workFlowName:ワークフロー名
executeTaskId:実行タスクID
logFileFolderPath:ログファイル保存フォルダパス
logTypeList:出力ログタイプ
logLevel:ログの出力レベル

処理:

logTypeListに基づいて、必要に応じてCloudLoggingUtil、LogFileUtil、ConsoleLoggingUtilを作成する。

戻り値:

なし

異常処理:

②　関数: WriteLog

機能:

ログを出力する。

public override void WriteLog(string msg, LogLevelEnum msgType);

引数:

msg:ログ内容
msgType:ログレベル

処理:

ログを必要に応じてCloud、ファイル、コンソールに出力する。

戻り値:

なし

異常処理:

③　関数:

LogDebug

機能:

Debugレベルのログ出力のインターフェース関数。

void LogDebug(string msg);

引数:

msg:ログ内容

2
2
2
2
2
2
2
2
2

2

2

2

2

処理:

戻り値:

なし

異常処理:

④　関数:

LogProcess

機能:

Processログを出力する。

public override void LogProcess(string msg);

引数:

msg:ログ内容

処理:

Processログを、Console以外の他の種類のログに出力する

・CloudlLogging
・Local

戻り値:

なし

異常処理:

⑤　関数:

LogInfo

機能:

Infoレベルのログを出力する。

public override void LogInfo(string msg);

引数:

msg:ログ内容

処理:

Infoレベルのログを必要に応じてCloud、ファイル、コンソールに出力する。

戻り値:

なし

異常処理:

⑥　関数:

LogWarn

機能:

Warnレベルのログを出力する。

public override void LogWarn(string msg);

引数:

msg:ログ内容

処理:

Warnレベルのログを必要に応じてCloud、ファイル、コンソールに出力する。

戻り値:

なし

異常処理:

⑦　関数:

LogError

機能:

Errorレベルのログを出力する。

public override void LogError(string msg);

引数:

msg:ログ内容

処理:

Errorレベルのログを必要に応じてCloud、ファイル、コンソールに出力する。

戻り値:

なし

異常処理:

⑧　関数:

LogException

機能:

異常情報を出力する。

public override void LogException(Exception ex);

引数:

ex:異常

処理:

異常情報を必要に応じてCloud、ファイル、コンソールに出力する。

戻り値:

なし

異常処理:





================================================================================
ドキュメント: プログラム基本設計書_基礎-コンポーネント_LogUtil_処理詳細_V1.pdf (PDF 3)
ファイル名: プログラム基本設計書_基礎-コンポーネント_LogUtil_処理詳細_V1.pdf
================================================================================

3-1.処理詳細説明(全体)

プログラムID

LogUtil

詳細内容

・目的

f013カタログ部品データ作成

システム名
業務機能名 基礎-コンポーネント
プログラム名称 LogUtil

システムID
バージョン
プロジェクトNo

作成日
更新日

2025/2/8

作成者
2025/10/30 更新者
区分

3H.薛宸
3H.薛宸

汎用

12000599-00

改訂No. 削

累積や累計などのPGに共通している部分を共通のDLLとして作成し、システムの安定性と開発効率を向上させる

・概要

システムにおける各種ログ出力の要件として、以下の出力先を実装する。

1 コンソール出力

アプリケーションの標準出力にログを出力する。
開発・デバッグ用途として利用し、

2 ログファイル出力

ログをファイルに記録し、システム運用時のトラブルシューティングや監査に活用する。
出力先のパス、ログのローテーション設定、および保持期間を適切に設計する。

3 クラウドロギング

CloudLoggingを使って、処理ログを指定の箇所に出力する。

・ログ出力制御ルール

LogType

メッセージタイプ

ログの種類

コンソールログ

ローカルログ Cloud Logging　※1

※1：常にスタックトレースを出す

Debug

Release

ERROR
WARNING
INFORMATION
PROCESS
STACKTRACE
ERROR
WARNING
INFORMATION
PROCESS
STACKTRACE

CloudLogging：

debug：

〇
〇
〇
〇
✖
〇
〇
〇
✖
✖

〇
〇
〇
〇
〇
〇
〇
〇
✖
✖

〇
〇
〇
〇
〇
〇
〇
〇
✖
〇

すべてのログを出力する

INFORMATION、PROCESS、WARNING、ERROR、STACKTRACE

release：

PROCESS以外のログを出力する

INFORMATION、WARNING、ERROR、STACKTRACE

ローカルログ：

ローカルログとして1つのファイルに出力し、ファイル名は『ツールID.log』とする。

debug：

2
2

2

2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2

2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2
2

すべてのログを出力する

INFORMATION、PROCESS、WARNING、ERROR、STACKTRACE

release：

以下のログを出力する

INFORMATION、WARNING、ERROR、STACKTRACE

コンソールログ：

スタックトレースがコンソールログに出力されない

debug：

以下のログを出力する

INFORMATION、PROCESS、WARNING、ERROR

release：

以下のログを出力する

INFORMATION、WARNING、ERROR

・処理明細

各関数の動作を説明する。

クラス名:

ILog

機能:

インターフェースクラス。ログ出力を規格化するために使用されます。

①　関数: WriteLog

機能:

ログ出力のインターフェース関数。

void WriteLog(string msg, LogLevelEnum logLevel);

msg:ログ内容
logLevel:ログレベル

引数:

処理:

戻り値:

なし

異常処理:

②　関数:

LogDebug

機能:

Debugレベルのログ出力のインターフェース関数。

void LogDebug(string msg);

引数:

msg:ログ内容

処理:

2

2

2

戻り値:

なし

異常処理:

③　関数:

LogProcess

機能:

Processログ出力のインターフェース関数。

void LogProcess(string msg);

引数:

msg:ログ内容

処理:

戻り値:

なし

異常処理:

④　関数:

LogInfo

機能:

Infoレベルのログ出力のインターフェース関数。

void LogInfo(string msg);

引数:

msg:ログ内容

処理:

戻り値:

なし

異常処理:

⑤　関数:

LogWarn

機能:

Warnレベルのログ出力のインターフェース関数。

void LogWarn(string msg);

引数:

msg:ログ内容

処理:

戻り値:

なし

異常処理:

⑥　関数:

LogError

機能:

Errorレベルのログ出力のインターフェース関数。

void LogError(string msg);

引数:

msg:ログ内容

処理:

戻り値:

なし

異常処理:

⑦　関数:

LogException

機能:

異常情報出力のインターフェース関数。

void LogException(Exception ex);

引数:

ex:異常

処理:

戻り値:

なし

異常処理:

クラス名:

LogLevelEnum

機能:

列挙型クラス。ログレベルを定義する。

DEBUG
PROCESS
INFO
WARN
ERROR

クラス名:

AbstractLog

機能:

抽象クラス。ILogを継承し、ログ内容のフォーマットなどのメソッドを提供する。

①　関数: AbstractLog

機能:

コンストラクタ。ログ内容のタイトルをフォーマットする。

public AbstractLog(LogLabel logLabel，string logLevel)

引数:

logLabel：

nameSpace:ネームスペース
workFlowName:ワークフロー名
executeTaskId:実行タスクID

logLevel:ログの出力レベル

処理:

タイトルをフォーマットする。

2

2

2
2
2
2

2

戻り値:

なし

異常処理:

②　関数:

FormatMsg

機能:

ログ内容をフォーマットする。

public string FormatMsg(string msg, LogLevelEnum msgType)

引数:

msg:ログ内容
msgType:ログレベル

処理:

ログ内容をフォーマットする。

戻り値:

string, フォーマットされたログ内容

異常処理:

③　関数: GetNowJapanDateTime

機能:

現在時刻(Japan)を取得する。

public DateTime GetNowJapanDateTime()

引数:

なし

処理:

現在時刻(Japan)の取得

戻り値:

DateTime:現在時刻(Japan)

異常処理:

④　関数:

IsDebugMode

機能:

デバッグモードかどうかを判定する

public bool IsDebugMode()

引数:

処理:

デバッグモードかどうかを判定する

戻り値:

logLevel が 「debug」の場合は true
「release」の場合は false

異常処理:

クラス名:

CloudLoggingUtil

機能:

AbstractLog抽象クラスを実装し、Cloudログを書き込むためのインターフェース関数をカプセル化する。

①　関数: CloudLoggingUtil

2
2
2
2
2
2
2
2
2
2
2
2
2

機能:

コンストラクタ。CloudLogging APIを初期化する。

public CloudLoggingUtil(string projectId, string logId, LogLabel logLabel,string logLevel) : base(loglabel,logLevel)

引数:

projectId:GCPプロジェクトID
logId:ログインスタンス名
logLabel：

nameSpace:ネームスペース
workFlowName:ワークフロー名
executeTaskId:実行タスクID

logLevel:ログの出力レベル

処理:

CloudLogging APIインスタンスを初期化する。

戻り値:

なし

異常処理:

②　関数: WriteLog

機能:

ログを出力する。

public override void WriteLog(string msg, LogLevelEnum msgType);

引数:

msg:ログ内容
msgType:ログレベル

処理:

ログをCloudに出力する。

戻り値:

なし

異常処理:

③　関数:

LogDebug

機能:

Debugレベルのログ出力のインターフェース関数。

void LogDebug(string msg);

引数:

msg:ログ内容

処理:

戻り値:

なし

異常処理:

④　関数:

LogProcess

機能:

Processログを出力する。

2
2
2
2
2

2

2

public override void LogProcess(string msg);

引数:

msg:ログ内容

処理:

logLevelが「release」に設定されている場合は、Processログを出力しません。
「debug」に設定されている場合は、Processログを出力します。

2

2
2

戻り値:

なし

異常処理:

⑤　関数:

LogInfo

機能:

Infoレベルのログを出力する。

public override void LogInfo(string msg);

引数:

msg:ログ内容

処理:

InfoレベルのログをCloudに出力する。

戻り値:

なし

異常処理:

⑥　関数:

LogWarn

機能:

Warnレベルのログを出力する。

public override void LogWarn(string msg);

引数:

msg:ログ内容

処理:

WarnレベルのログをCloudに出力する。

戻り値:

なし

異常処理:

⑦　関数:

LogError

機能:

Errorレベルのログを出力する。

public override void LogError(string msg);

引数:

msg:ログ内容

処理:

ErrorレベルのログをCloudに出力する。

戻り値:

なし

異常処理:

⑧　関数:

LogException

機能:

異常情報を出力する。

public override void LogException(Exception ex);

引数:

ex:異常

処理:

異常情報をCloudに出力する。

戻り値:

なし

異常処理:

クラス名:

LogFileUtil

機能:

AbstractLog抽象クラスを実装し、ログファイルを書き込むためのインターフェース関数をカプセル化する。

①　関数:

LogFileUtil

機能:

コンストラクタ。ログディレクトリを初期化する。

public LogFileUtil(string logFilePath, LogLabel logLabel ,string logLevel) : base(logLabel,logLevel)

引数:

logFilePath:ログファイルのパス
logLabel：

nameSpace:ネームスペース
workFlowName:ワークフロー名
executeTaskId:実行タスクID

logLevel:ログの出力レベル

処理:

ログディレクトリを初期化します。

戻り値:

なし

異常処理:

②　関数: WriteLog

機能:

ログを出力する。

public override void WriteLog(string msg, LogLevelEnum msgType);

引数:

処理:

msg:ログ内容
msgType:ログレベル

logLevelが「release」に設定されている場合は、Processログを出力しません。
「debug」に設定されている場合は、Processログを出力します。

戻り値:

なし

2
2
2
2
2

2
2

異常処理:

③　関数:

LogDebug

機能:

Debugレベルのログ出力のインターフェース関数。

void LogDebug(string msg);

引数:

msg:ログ内容

処理:

戻り値:

なし

異常処理:

④　関数:

LogProcess

機能:

Processログを出力する。

public override void LogProcess(string msg);

引数:

msg:ログ内容

処理:

Processログをファイルに出力する。

戻り値:

なし

異常処理:

⑤　関数:

LogInfo

機能:

Infoレベルのログを出力する。

public override void LogInfo(string msg);

引数:

msg:ログ内容

処理:

Infoレベルのログをファイルに出力する。

戻り値:

なし

異常処理:

⑥　関数:

LogWarn

機能:

Warnレベルのログを出力する。

public override void LogWarn(string msg);

引数:

msg:ログ内容

2

2

2

2

処理:

Warnレベルのログをファイルに出力する。

戻り値:

なし

異常処理:

⑦　関数:

LogError

機能:

Errorレベルのログを出力する。

public override void LogError(string msg);

引数:

msg:ログ内容

処理:

Errorレベルのログをファイルに出力する。

戻り値:

なし

異常処理:

⑧　関数:

LogException

機能:

異常情報を出力する。

public override void LogException(Exception ex);

引数:

ex:異常

処理:

異常メッセージはreleaseログファイルに出力するが、スタックトレース情報はreleaseログファイルには出力しない。
logLevelが「debug」に設定されている場合は、異常メッセージおよびスタックトレース情報の両方をログファイルに出力する。

戻り値:

なし

異常処理:

クラス名:

ConsoleLoggingUtil

機能:

AbstractLog抽象クラスを実装し、コンソールログを書き込むためのインターフェース関数をカプセル化する。

①　関数: ConsoleLoggingUtil

機能:

コンストラクタ。

public ConsoleLoggingUtil(LogLabel logLabel,string logLevel) : base(logLabel,logLevel)

引数:

logLabel：

nameSpace:ネームスペース
workFlowName:ワークフロー名
executeTaskId:実行タスクID

logLevel:ログレベル

2
2

2
2
2
2

2

処理:

戻り値:

なし

異常処理:

②　関数: WriteLog

機能:

ログを出力する。

public override void WriteLog(string msg, LogLevelEnum msgType);

引数:

処理:

msg:ログ内容
msgType:ログレベル

ログをコンソールに出力する。
logLevelが「release」に設定されている場合は、Processログを出力しません。
「debug」に設定されている場合は、Processログを出力します。

戻り値:

なし

異常処理:

③　関数:

LogDebug

機能:

Debugレベルのログ出力のインターフェース関数。

void LogDebug(string msg);

引数:

msg:ログ内容

処理:

戻り値:

なし

異常処理:

④　関数:

LogProcess

機能:

Processログを出力する。

public override void LogProcess(string msg);

引数:

msg:ログ内容

処理:

Processログをコンソールに出力する。

戻り値:

なし

異常処理:

2
2

2

2

2

2

⑤　関数:

LogInfo

機能:

Infoレベルのログを出力する。

public override void LogInfo(string msg);

引数:

msg:ログ内容

処理:

Infoレベルのログをコンソールに出力する。

戻り値:

なし

異常処理:

⑥　関数:

LogWarn

機能:

Warnレベルのログを出力する。

public override void LogWarn(string msg);

引数:

msg:ログ内容

処理:

Warnレベルのログをコンソールに出力する。

戻り値:

なし

異常処理:

⑦　関数:

LogError

機能:

Errorレベルのログを出力する。

public override void LogError(string msg);

引数:

msg:ログ内容

処理:

Errorレベルのログをコンソールに出力する。

戻り値:

なし

異常処理:

⑧　関数:

LogException

機能:

異常情報を出力しする。

public override void LogException(Exception ex);

引数:

ex:異常

処理:

異常（エラー）メッセージのみをコンソールに出力し、スタックトレースは出力しない。

2

戻り値:

なし

異常処理:

クラス名:

LogUtil

機能:

 ILogインターフェースを実装し、CloudLoggingUtil、LogFileUtil、ConsoleLoggingUtilを使用してログを書き込みます。

①　関数:

LogUtil

機能:

コンストラクタ。

public LogUtil(LogEntity log)

引数:

log:

projectId:GCPプロジェクトID
logId:ログインスタンス名
nameSpace:ネームスペース
workFlowName:ワークフロー名
executeTaskId:実行タスクID
logFileFolderPath:ログファイル保存フォルダパス
logTypeList:出力ログタイプ
logLevel:ログの出力レベル

処理:

logTypeListに基づいて、必要に応じてCloudLoggingUtil、LogFileUtil、ConsoleLoggingUtilを作成する。

戻り値:

なし

異常処理:

②　関数: WriteLog

機能:

ログを出力する。

public override void WriteLog(string msg, LogLevelEnum msgType);

引数:

msg:ログ内容
msgType:ログレベル

処理:

ログを必要に応じてCloud、ファイル、コンソールに出力する。

戻り値:

なし

異常処理:

③　関数:

LogDebug

機能:

Debugレベルのログ出力のインターフェース関数。

void LogDebug(string msg);

引数:

msg:ログ内容

2
2
2
2
2
2
2
2
2

2

2

2

2

処理:

戻り値:

なし

異常処理:

④　関数:

LogProcess

機能:

Processログを出力する。

public override void LogProcess(string msg);

引数:

msg:ログ内容

処理:

Processログを、Console以外の他の種類のログに出力する

・CloudlLogging
・Local

戻り値:

なし

異常処理:

⑤　関数:

LogInfo

機能:

Infoレベルのログを出力する。

public override void LogInfo(string msg);

引数:

msg:ログ内容

処理:

Infoレベルのログを必要に応じてCloud、ファイル、コンソールに出力する。

戻り値:

なし

異常処理:

⑥　関数:

LogWarn

機能:

Warnレベルのログを出力する。

public override void LogWarn(string msg);

引数:

msg:ログ内容

処理:

Warnレベルのログを必要に応じてCloud、ファイル、コンソールに出力する。

戻り値:

なし

異常処理:

⑦　関数:

LogError

機能:

Errorレベルのログを出力する。

public override void LogError(string msg);

引数:

msg:ログ内容

処理:

Errorレベルのログを必要に応じてCloud、ファイル、コンソールに出力する。

戻り値:

なし

異常処理:

⑧　関数:

LogException

機能:

異常情報を出力する。

public override void LogException(Exception ex);

引数:

ex:異常

処理:

異常情報を必要に応じてCloud、ファイル、コンソールに出力する。

戻り値:

なし

異常処理:


