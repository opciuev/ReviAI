
================================================================================
ドキュメント: プログラム基本設計書_B145_累積作成_部品一覧Excelロード_AI審査_七回目_V7.pdf (今回の設計書 V7)
ファイル名: プログラム基本設計書_B145_累積作成_部品一覧Excelロード_AI審査_七回目_V7.pdf
================================================================================

要求No 要求内容 (ペルソナ: 指令)

評価 (〇/△/×) 適合/不適合箇所

適合/不適合理由

修正案 (ゴールデンケースを含む)

対応有無 対応方法／非対応理由

SA-1

SystemArchitect: 論理トレーサビリティの検証 △

V7: 1.4 入力ファイルチェック

V6の設計書(2.4.1)に存在した「入力ファイル名が命名規則に従っているかのチェック」がV7では削除されてい
る。
必須マクロ変数の存在チェック(1.4.1)は残っているが、ファイル名自体の検証がなくなった理由が不明であ
り、呼び出し元プロセスに責務が移譲されたのか等の経緯が追跡できない。

ファイル名の命名規則への準拠性チェックが不要になった理由、または責務がど
のモジュールに移譲されたのかを注記として追記する。
例：「注記：ファイル名の命名規則への準拠は、本プラグインの呼び出し元プロセス
が保証するものとする。」

×

SA-2

SystemArchitect: 機能要件と非機能要件の分
離と結合

△

1.4.3.2 Excelファイルの読み込み

GCSからストリーム経由でファイルを読み込むという性能を考慮した設計は記載されているが、それに伴う非
機能要件（タイムアウト値、リトライ処理、巨大ファイル読み込み時のメモリ上限など）が定義されていない。
これにより、実運用時の性能問題や信頼性の欠如に繋がる可能性がある。

非機能要件として、GCS接続時のタイムアウト値、ネットワーク瞬断等の一時エ
ラー発生時のリトライ回数と間隔、および本プラグインが処理を保証する最大ファ
イルサイズや行数を明記する。

SA-3

SystemArchitect: 指摘事項への準拠 (V6->V7
改善点評価)

〇

3-1.処理詳細説明(全体) API定義

V6のAPI定義と比較して、V7では`Before`メソッドに`LogUtil`インスタンスをDI（依存性注入）する形式に変更
されている。また`After`メソッドも戻り値とout引数で結果を返す明確なI/Fとなっており、コンポーネントの疎結
合化とテスト容易性が向上している。
これはアーキテクチャとして優れた改善である。

（評価が「〇」のため修正案なし）

QA-1

QAManager: 処理ロジックの具体性評価 (WDT
分析)

×

2.2.2 固定値の設定

「Do(処理)」の具体性が著しく欠如している。「部品一覧Excelファイル名から車両モデル『!FS_CAR_MODEL!』」
のように、ファイル名から情報を抽出する仕様が記載されているが、その前提となるファイル名の命名規則
や、マクロ変数を解析するための具体的なロジック（区切り文字、位置など）が一切定義されていない。この記
述では実装もテストケース作成も不可能である。

**【ゴールデンケース】**
1. 参照するファイル名の命名規則を明記する。例: `部品一覧_{車両モデル}_{類別
コード}_{メイングループコード}_{サブグループコード}_{抽出日}.xlsx`
2. 各マクロ変数がファイル名のどの部分に、どのような形式（例: `抽出日`は
`YYYYMMDD`形式）で含まれるかを定義する。
3. マクロ変数がファイル名から抽出できなかった場合の例外処理（例: エラーログ
を出力し、処理を中断する）を定義する。

QA-2

QAManager: 用語と定義の明確化

QA-3

QAManager: 異常系の網羅性

△

〇

1.4.4.4 Excelファイルレイアウトのチェック

処理対象となるExcelの列名に、「Part desc」（英語）、「MFTBC Price」（大文字略語）、「ﾒｰｶｰｺｰﾄﾞ」（半角カ
ナ）など、言語や文字幅が統一されていない。これにより、入力ファイルの僅かな差異で処理エラーが発生す
る可能性があり、仕様として曖昧さが残る。

処理対象のExcelヘッダの列名を、日本語（全角）に統一する。例：「Part desc」→
「部品名称」、「MFTBC Price」→「MFTBC価格」、「ﾒｰｶｰｺｰﾄﾞ」→「メーカーコード」。
仕様書内で許容する表記を一つに定める。

1.3, 1.4, 2.2.3

ファイルの存在チェック、0バイトチェック、複数シート、カラム数・名称・順序の不一致など、ファイル入力に関
する異常系が網羅的に定義され、それぞれに固有のExitCodeが割り当てられている。また、レコード単位の
エラー発生時の挙動も「resume/skip/terminate」の3モードで定義されており、テスト設計に必要な情報が十
分に記述されている。

（評価が「〇」のため修正案なし）

×

×

×

×

×

　V6版の設計（ファイル名チェックを含む）は、責務の分離に違反していた
ため、V7で意図的に削除した。本プラグイン（Excelロード）の責務はファイ
ル内容の検証であり、ファイル名の検証は呼び出し元プロセスの責務で
ある。アーキテクチャ方針の正当性に基づき、本件（注記の追記）は対応
しない。

　ご指摘の非機能要件（タイムアウト、リトライ）は、本プラグインが利用す
る下位コンポーネント「GcsUtil」の責務である。「GcsUtil」の設計書にて既
に定義済みであり、上位のプラグイン設計書で重複して定義することは、
管理の複雑化を招くため行わない。本プラグインは「GcsUtil」がスローし
た例外をそのまま呼び出し元に通知する設計とする。

　プラグインの設計を根本的に誤解している。本プラグインのルールは動
的（Dynamic）であり、審査員が提案するような静的（Static）なルール で
はない。

　ご指摘の列名（「Part desc」、「ﾒｰｶｰｺｰﾄﾞ」等）は、顧客提供の入力ファイ
ルレイアウトに基づく外部仕様であるため、設計者（当方）の判断で変更
することは不可能である。本プラグインは、この不統一な（英語、半角カナ
を含む）レイアウトを仕様として正しくハンドリングする必要がある。よっ
て、この修正案（日本語全角への統一）は採用しない。

QA-4

QAManager: 処理ロジックの具体性評価 (WDT
分析)

△

2.2.1 項目のマッピングとカラム操作

価格グループに関するカラム操作で「トリム後空文字になる場合は1バイトのスペースを設定する」という記述
があるが、なぜこのような特殊な処理が必要なのか、その背景（ビジネスルールや後続システムの制約など）
が一切説明されていない。理由が不明なため、この仕様が正しいかどうかをテスト担当者が判断できない。

特殊な仕様の背景を注記として追記する。例：「注記：後続のデータ連携先システ
ムが価格グループのNULL/空文字を許容しないため、空の場合は半角スペースを
デフォルト値として設定する。」

×

　ご指摘の処理（空文字の場合、1バイトのスペースを設定する）も、QA-2
（列名）と同様に顧客から提示された外部仕様書に準拠したものである。
これは当方で変更・解釈できる範囲を超えている。仕様書に記載された通
りの実装を行うため、背景の追記（注記）は行わない。





================================================================================
ドキュメント: プログラム基本設計書_B145_累積作成_部品一覧Excelロード_AI審査_七回目_V7.pdf (今回の設計書 V7)
ファイル名: プログラム基本設計書_B145_累積作成_部品一覧Excelロード_AI審査_七回目_V7.pdf
================================================================================

要求No 要求内容 (ペルソナ: 指令)

評価 (〇/△/×) 適合/不適合箇所

適合/不適合理由

修正案 (ゴールデンケースを含む)

対応有無 対応方法／非対応理由

SA-1

SystemArchitect: 論理トレーサビリティの検証 △

V7: 1.4 入力ファイルチェック

V6の設計書(2.4.1)に存在した「入力ファイル名が命名規則に従っているかのチェック」がV7では削除されてい
る。
必須マクロ変数の存在チェック(1.4.1)は残っているが、ファイル名自体の検証がなくなった理由が不明であ
り、呼び出し元プロセスに責務が移譲されたのか等の経緯が追跡できない。

ファイル名の命名規則への準拠性チェックが不要になった理由、または責務がど
のモジュールに移譲されたのかを注記として追記する。
例：「注記：ファイル名の命名規則への準拠は、本プラグインの呼び出し元プロセス
が保証するものとする。」

×

SA-2

SystemArchitect: 機能要件と非機能要件の分
離と結合

△

1.4.3.2 Excelファイルの読み込み

GCSからストリーム経由でファイルを読み込むという性能を考慮した設計は記載されているが、それに伴う非
機能要件（タイムアウト値、リトライ処理、巨大ファイル読み込み時のメモリ上限など）が定義されていない。
これにより、実運用時の性能問題や信頼性の欠如に繋がる可能性がある。

非機能要件として、GCS接続時のタイムアウト値、ネットワーク瞬断等の一時エ
ラー発生時のリトライ回数と間隔、および本プラグインが処理を保証する最大ファ
イルサイズや行数を明記する。

SA-3

SystemArchitect: 指摘事項への準拠 (V6->V7
改善点評価)

〇

3-1.処理詳細説明(全体) API定義

V6のAPI定義と比較して、V7では`Before`メソッドに`LogUtil`インスタンスをDI（依存性注入）する形式に変更
されている。また`After`メソッドも戻り値とout引数で結果を返す明確なI/Fとなっており、コンポーネントの疎結
合化とテスト容易性が向上している。
これはアーキテクチャとして優れた改善である。

（評価が「〇」のため修正案なし）

QA-1

QAManager: 処理ロジックの具体性評価 (WDT
分析)

×

2.2.2 固定値の設定

「Do(処理)」の具体性が著しく欠如している。「部品一覧Excelファイル名から車両モデル『!FS_CAR_MODEL!』」
のように、ファイル名から情報を抽出する仕様が記載されているが、その前提となるファイル名の命名規則
や、マクロ変数を解析するための具体的なロジック（区切り文字、位置など）が一切定義されていない。この記
述では実装もテストケース作成も不可能である。

**【ゴールデンケース】**
1. 参照するファイル名の命名規則を明記する。例: `部品一覧_{車両モデル}_{類別
コード}_{メイングループコード}_{サブグループコード}_{抽出日}.xlsx`
2. 各マクロ変数がファイル名のどの部分に、どのような形式（例: `抽出日`は
`YYYYMMDD`形式）で含まれるかを定義する。
3. マクロ変数がファイル名から抽出できなかった場合の例外処理（例: エラーログ
を出力し、処理を中断する）を定義する。

QA-2

QAManager: 用語と定義の明確化

QA-3

QAManager: 異常系の網羅性

△

〇

1.4.4.4 Excelファイルレイアウトのチェック

処理対象となるExcelの列名に、「Part desc」（英語）、「MFTBC Price」（大文字略語）、「ﾒｰｶｰｺｰﾄﾞ」（半角カ
ナ）など、言語や文字幅が統一されていない。これにより、入力ファイルの僅かな差異で処理エラーが発生す
る可能性があり、仕様として曖昧さが残る。

処理対象のExcelヘッダの列名を、日本語（全角）に統一する。例：「Part desc」→
「部品名称」、「MFTBC Price」→「MFTBC価格」、「ﾒｰｶｰｺｰﾄﾞ」→「メーカーコード」。
仕様書内で許容する表記を一つに定める。

1.3, 1.4, 2.2.3

ファイルの存在チェック、0バイトチェック、複数シート、カラム数・名称・順序の不一致など、ファイル入力に関
する異常系が網羅的に定義され、それぞれに固有のExitCodeが割り当てられている。また、レコード単位の
エラー発生時の挙動も「resume/skip/terminate」の3モードで定義されており、テスト設計に必要な情報が十
分に記述されている。

（評価が「〇」のため修正案なし）

×

×

×

×

×

　V6版の設計（ファイル名チェックを含む）は、責務の分離に違反していた
ため、V7で意図的に削除した。本プラグイン（Excelロード）の責務はファイ
ル内容の検証であり、ファイル名の検証は呼び出し元プロセスの責務で
ある。アーキテクチャ方針の正当性に基づき、本件（注記の追記）は対応
しない。

　ご指摘の非機能要件（タイムアウト、リトライ）は、本プラグインが利用す
る下位コンポーネント「GcsUtil」の責務である。「GcsUtil」の設計書にて既
に定義済みであり、上位のプラグイン設計書で重複して定義することは、
管理の複雑化を招くため行わない。本プラグインは「GcsUtil」がスローし
た例外をそのまま呼び出し元に通知する設計とする。

　プラグインの設計を根本的に誤解している。本プラグインのルールは動
的（Dynamic）であり、審査員が提案するような静的（Static）なルール で
はない。

　ご指摘の列名（「Part desc」、「ﾒｰｶｰｺｰﾄﾞ」等）は、顧客提供の入力ファイ
ルレイアウトに基づく外部仕様であるため、設計者（当方）の判断で変更
することは不可能である。本プラグインは、この不統一な（英語、半角カナ
を含む）レイアウトを仕様として正しくハンドリングする必要がある。よっ
て、この修正案（日本語全角への統一）は採用しない。

QA-4

QAManager: 処理ロジックの具体性評価 (WDT
分析)

△

2.2.1 項目のマッピングとカラム操作

価格グループに関するカラム操作で「トリム後空文字になる場合は1バイトのスペースを設定する」という記述
があるが、なぜこのような特殊な処理が必要なのか、その背景（ビジネスルールや後続システムの制約など）
が一切説明されていない。理由が不明なため、この仕様が正しいかどうかをテスト担当者が判断できない。

特殊な仕様の背景を注記として追記する。例：「注記：後続のデータ連携先システ
ムが価格グループのNULL/空文字を許容しないため、空の場合は半角スペースを
デフォルト値として設定する。」

×

　ご指摘の処理（空文字の場合、1バイトのスペースを設定する）も、QA-2
（列名）と同様に顧客から提示された外部仕様書に準拠したものである。
これは当方で変更・解釈できる範囲を超えている。仕様書に記載された通
りの実装を行うため、背景の追記（注記）は行わない。


