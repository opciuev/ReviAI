# 💼 AI評審作業 フロー整理（プログラム基本設計書）

---

## 🧩 全体フロー概要

AI評審の作業フローは、以下の **3つの主要段階** に分かれています。

1. **PDF生成（Excelから出力）**  
2. **AI評審（Gemini Pro 2.5による分析）**  
3. **評審結果整理（Excelへの保存）**

各段階には、入力・出力・命名規則・処理内容が明確に定義されています。

---

## 🧱 第1段階：ExcelからPDFを出力

### 🎯 目的
プログラム基本設計書（Excelファイル）から、指定されたシートをA4横向きPDFとして出力し、AI評審に使用する。

---

### 📄 入力
- Excelファイル名：  
  `プログラム基本設計書_累積作成ツール.xlsx`

- ユーザー指定：
  - 出力対象の **シート名**（1つ以上選択可能）  
    例：`プログラム概要`, `処理詳細`
  - **バージョン番号（数字のみ）**  
    例：`6`

---

### ⚙️ 処理内容
- 指定された各シートを個別にPDFとして出力。
- ページ設定：
  - 用紙サイズ：A4 横向き（Landscape）
  - 幅方向：すべての列を1ページに収める（FitToPagesWide = 1）
  - 高さ方向：必要に応じて自動改ページ（FitToPagesTall = False）
  - Excelの書式（フォント、色、罫線など）を保持
- シートごとに1つのPDFファイルを生成

---

### 💾 出力
出力ファイル命名ルール：
```
{元Excelファイル名}_{シート名}_V{バージョン番号}.pdf
```

**出力例：**
```
プログラム基本設計書_累積作成ツール_プログラム概要_V6.pdf
プログラム基本設計書_累積作成ツール_処理詳細_V6.pdf
```

---

## 🤖 第2段階：AI評審（Gemini Pro 2.5）

### 🎯 目的
AIモデル（Gemini Pro 2.5）を用いて、前バージョンのPDFを自動的に評価・比較し、改善点を抽出する。

---

### 📄 入力
前回バージョンのPDF：
```
プログラム基本設計書_累積作成ツール_プログラム概要_V5.pdf
プログラム基本設計書_累積作成ツール_処理詳細_V5.pdf
```

およびユーザーが準備した「評審プロンプト（指示文）」。

---

### ⚙️ 処理内容
Gemini Pro 2.5にてAI評審を実施。  
AIは与えられたプロンプトに基づき、各要求項目に対する評価および修正提案を出力。

---

### 💾 出力（AI生成）
AIが生成する表形式の出力フォーマット：

| 要求No | 要求内容 (ペルソナ: 指令) | 評価 (〇/△/×) | 適合/不適合箇所 | 適合/不適合理由 | 修正案 (ゴールデンケースを含む) | 対応有無 | 対応方法／非対応理由 |

この表は次の段階でExcelに整理・保存される。

---

## 📊 第3段階：評審結果の整理と保存

### 🎯 目的
AIの出力結果（表データ）をExcel形式にまとめ、第N回の評審結果ファイルを作成する。

---

### 📄 入力
AI出力の表データ（上記フォーマット）。

---

### 💾 出力
Excelファイル：
```
第六回.xlsx
```

---

### ⚙️ フォーマット仕様
1. **タイトル行の背景色**：淡い青色  
2. **フィルター（AutoFilter）を有効化**  
3. **全セルに罫線を付与**  
4. **内容のある行・列のサイズを自動調整（AutoSize）**

---

## 🏁 フロー完了条件
以下のファイルが生成された時点で、AI評審プロセスは完了となる。

- **PDF（最新版）**
  ```
  プログラム基本設計書_累積作成ツール_プログラム概要_V6.pdf
  プログラム基本設計書_累積作成ツール_処理詳細_V6.pdf
  ```

- **AI評審結果（Excel）**
  ```
  第六回.xlsx
  ```

---

## 🧭 全体まとめ

| 段階 | 操作内容 | 入力 | 出力 |
|------|-----------|------|------|
| 第1段階 | ExcelからPDFを生成 | Excel原本 + シート選択 + バージョン番号 | 横向きPDF（1シート1ファイル） |
| 第2段階 | Gemini Pro 2.5でAI評審 | 旧バージョンPDF + プロンプト | 評価表（AI出力） |
| 第3段階 | 評審結果をExcelへ保存 | AI出力表データ | フォーマット済みExcel（第N回） |

---

## ✅ 備考
- バージョン番号は「V」付きで自動付加（例：入力が6 → 出力は `_V6`）  
- 各工程は将来的に自動化スクリプトで一括実行可能  
- PDFはA4横向き、全列を1ページに収める設定で統一
